<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/senko/System.js | senkowsh</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="JScirpt library for WSH that gathers various functions."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="senkowsh"><meta property="twitter:description" content="JScirpt library for WSH that gathers various functions."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/natade-jp/SenkoWSH"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SenkoWSH">SenkoWSH</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#konpeito">konpeito</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/konpeito/Random.js~Random.html">Random</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#mojijs">mojijs</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/mojijs/Japanese.js~Japanese.html">Japanese</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/mojijs/StringComparator.js~StringComparator.html">StringComparator</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#senko">senko</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/CSV.js~CSV.html">CSV</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/Dialog.js~Dialog.html">Dialog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/Format.js~Format.html">Format</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/Robot.js~Robot.html">Robot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/SFile.js~SFile.html">SFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/System.js~System.html">System</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-OpenDirectoryOption">OpenDirectoryOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-OpenFileOption">OpenFileOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-PopupOption">PopupOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SaveAsOption">SaveAsOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-KeyEventOption">KeyEventOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MouseEventFCodes">MouseEventFCodes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MouseEventOption">MouseEventOption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RobotGetHandleData">RobotGetHandleData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-VirtualKeyCode">VirtualKeyCode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-VirtualKeyCodes">VirtualKeyCodes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-WSHRobotPosition">WSHRobotPosition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-WSHRobotRect">WSHRobotRect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SystemExecResult">SystemExecResult</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#senko-polyfill">senko/polyfill</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/polyfill/ExtendsArray.js~ExtendsArray.html">ExtendsArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/polyfill/ExtendsObject.js~ExtendsObject.html">ExtendsObject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/senko/polyfill/ExtendsString.js~ExtendsString.html">ExtendsString</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/senko/System.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * The script is part of SenkoWSH.
 * 
 * AUTHOR:
 *  natade (http://twitter.com/natadea)
 * 
 * LICENSE:
 *  The MIT license https://opensource.org/licenses/MIT
 */

import Polyfill from &quot;./polyfill/Polyfill.js&quot;;
import Format from &quot;./Format.js&quot;;

/**
 * @type {boolean}
 * @private
 */
const is_wscript = /wscript\.exe$/i.test(WSH.FullName);

/**
 * @type {boolean}
 * @private
 */
const is_cscript = /cscript\.exe$/i.test(WSH.FullName);

/**
 * &#x6587;&#x5B57;&#x5217;&#x3078;&#x5909;&#x63DB;&#x3057;&#x307E;&#x3059;&#x3002;
 * @param {any} data 
 * @private
 */
const toString = function(data) {
	if(data === null) {
		return &quot;[null]&quot;;
	}
	else if(data === undefined) {
		return &quot;[undefined]&quot;;
	}
	const string_data = data.toString();
	if(string_data === &quot;[object Error]&quot;) {
		const e = data;
		const error_name	= e.name ? e.name : &quot;Error&quot;;
		const error_number	= e.number ? Format.textf(&quot;0x%08X&quot;, e.number) : &quot;0x00000000&quot;;
		const error_message	= e.message ? e.message : &quot;&#x30A8;&#x30E9;&#x30FC;&#x304C;&#x767A;&#x751F;&#x3057;&#x307E;&#x3057;&#x305F;&#x3002;&quot;;
		return Format.textf(&quot;%s(%s) %s&quot;, error_name, error_number, error_message);
	}
	return string_data;
};


/**
 * &#x5B9F;&#x884C;&#x7D50;&#x679C;
 * @typedef {Object} SystemExecResult
 * @property {string} out
 * @property {string} error
 * @property {number} exit_code
 */

/**
 * &#x30B7;&#x30B9;&#x30C6;&#x30E0;&#x7528;&#x306E;&#x30AF;&#x30E9;&#x30B9;
 * - &#x6587;&#x5B57;&#x5217;&#x306E;&#x5165;&#x51FA;&#x529B;
 * - &#x30B9;&#x30EA;&#x30FC;&#x30D7;&#x3001;&#x505C;&#x6B62;
 * - GUI&#x30E2;&#x30FC;&#x30C9;&#x3001;CUI&#x30E2;&#x30FC;&#x30C9;&#x306E;&#x5207;&#x308A;&#x66FF;&#x3048;
 * - &#x30D0;&#x30C3;&#x30C1;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x3078;&#x306E;&#x5F15;&#x6570;&#x306E;&#x60C5;&#x5831;
 * - &#x30AB;&#x30EC;&#x30F3;&#x30C8;&#x30C7;&#x30A3;&#x30EC;&#x30AF;&#x30C8;&#x30EA;&#x60C5;&#x5831;
 */
export default class System {

	/**
	 * &#x6587;&#x5B57;&#x5217;&#x3092;&#x8868;&#x793A;&#xFF08;&#x6700;&#x7D42;&#x884C;&#x3067;&#x81EA;&#x52D5;&#x3067;&#x6539;&#x884C;&#x3055;&#x308C;&#x306A;&#x3044;&#xFF09;
	 * @param {any} text
	 */
	static print(text) {
		const output = toString(text);
		if(is_cscript) {
			WSH.StdOut.Write(output);
		}
		else {
			WScript.Echo(output);
		}
	}

	/**
	 * &#x6587;&#x5B57;&#x5217;&#x3092;&#x8868;&#x793A;&#xFF08;&#x6700;&#x7D42;&#x884C;&#x3067;&#x81EA;&#x52D5;&#x3067;&#x6539;&#x884C;&#x3055;&#x308C;&#x308B;&#xFF09;
	 * @param {any} text
	 */
	static println(text) {
		const output = toString(text);
		if(is_cscript) {
			System.print(output + &quot;\n&quot;);
		}
		else {
			System.print(output);
		}
	}

	/**
	 * &#x6307;&#x5B9A;&#x3057;&#x305F;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;&#x3067;&#x6574;&#x5F62;&#x3057;&#x305F;&#x6587;&#x5B57;&#x5217;&#x3092;&#x8868;&#x793A;
	 * @param {any} text 
	 * @param {...any} parm &#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306F;&#x53EF;&#x5909;&#x5F15;&#x6570;
	 */
	static printf() {
		const x = [];
		for(let i = 0 ; i &lt; arguments.length ; i++) {
			x[i] = arguments[i];
			if(i === 0) {
				x[i] = toString(x[i]);
			}
		}
		System.println(Format.textf.apply(this, x));
	}

	/**
	 * &#x30AD;&#x30FC;&#x30DC;&#x30FC;&#x30C9;&#x306E;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x5165;&#x529B;&#x3092;&#x53D6;&#x5F97;
	 * @returns {string}
	 */
	static readLine() {
		return WScript.StdIn.ReadLine();
	}
	
	/**
	 * UNIX&#x6642;&#x9593;&#x3092;&#x30DF;&#x30EA;&#x79D2;&#x3067;&#x53D6;&#x5F97;
	 * @returns {number}
	 */
	static currentTimeMillis() {
		const date = new Date();
		return date.getTime();
	}

	/**
	 * &#x51E6;&#x7406;&#x3092;&#x4E00;&#x6642;&#x505C;&#x6B62;
	 * @param {number} time_sec &#x505C;&#x6B62;&#x3059;&#x308B;&#x79D2;&#x6570;
	 */
	static sleep(time_sec) {
		WScript.Sleep((time_sec * 1000) | 0);
	}
	
	/**
	 * &#x51E6;&#x7406;&#x3092;&#x505C;&#x6B62;
	 */
	static stop() {
		while(true) {
			WScript.Sleep(1000);
		}
	}
	
	/**
	 * &#x30D3;&#x30FC;&#x30D7;&#x97F3;&#x3092;&#x9CF4;&#x3089;&#x3059;
	 * @param {number} frequency_hz - &#x5468;&#x6CE2;&#x6570;
	 * @param {number} time_sec - &#x9CF4;&#x3089;&#x3059;&#x79D2;&#x6570;
	 */
	static beep(frequency_hz, time_sec) {
		System.WindowsAPI(
			&quot;kernel32.dll&quot;,
			&quot;bool Beep(uint dwFreq, uint dwDuration)&quot;,
			&quot;$api::Beep(&quot; + (frequency_hz | 0) + &quot;, &quot; + ((time_sec * 1000) | 0) + &quot;);&quot;
		);
	}

	/**
	 * &#x6307;&#x5B9A;&#x3057;&#x305F;&#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x3092;&#x5225;&#x30D7;&#x30ED;&#x30BB;&#x30B9;&#x3068;&#x3057;&#x3066;&#x5B9F;&#x884C;&#x3059;&#x308B;
	 * @param {string} command - &#x30B3;&#x30DE;&#x30F3;&#x30C9;
	 * @param {number} [style=1] - &#x8D77;&#x52D5;&#x30AA;&#x30D7;&#x30B7;&#x30E7;&#x30F3;
	 * @param {boolean} [is_wait=false] - &#x30D7;&#x30ED;&#x30BB;&#x30B9;&#x304C;&#x7D42;&#x4E86;&#x3059;&#x308B;&#x307E;&#x3067;&#x5F85;&#x3064;
	 */
	static run(command, style, is_wait) {
		const NormalFocus = 1;
		const intWindowStyle = style !== undefined ? style : NormalFocus;
		const bWaitOnReturn = is_wait !== undefined ? is_wait : false;
		const shell = WScript.CreateObject(&quot;WScript.Shell&quot;);
		// @ts-ignore
		return shell.Run(command, intWindowStyle, bWaitOnReturn);
	}

	/**
	 * &#x6307;&#x5B9A;&#x3057;&#x305F;&#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x3092;&#x5B50;&#x30D7;&#x30ED;&#x30BB;&#x30B9;&#x3068;&#x3057;&#x3066;&#x5B9F;&#x884C;&#x3059;&#x308B;
	 * @param {string} command 
	 * @returns {SystemExecResult}
	 */
	static exec(command) {
		const shell = WScript.CreateObject(&quot;WScript.Shell&quot;);
		const exec = shell.Exec(command);
		const stdin = exec.StdIn;
		const stdout = exec.StdOut;
		const stderr = exec.StdErr;
		while(exec.Status === 0) {
			WScript.Sleep(10);
		}
		const exit_code = exec.ExitCode;
		stdin.Close();
		// @ts-ignore
		const out = stdout.ReadAll().replace(/\r?\n$/, &quot;&quot;);
		stdout.Close();
		// @ts-ignore
		const error = stderr.ReadAll().replace(/\r?\n$/, &quot;&quot;);
		stderr.Close();
		return {
			exit_code : exit_code,
			out : out,
			error : error
		};
	}
	
	/**
	 * &#x6307;&#x5B9A;&#x3057;&#x305F;&#x5909;&#x6570;&#x304C;&#x5B9A;&#x7FA9;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x304B;&#x8ABF;&#x3079;&#x308B;
	 * @param {string} variable_name
	 * @returns {boolean}
	 */
	 static isDefined(variable_name) {
		return variable_name in globalThis;
	}
	
	/**
	 * &#x30D7;&#x30ED;&#x30B0;&#x30E9;&#x30E0;&#x3092;&#x7D42;&#x4E86;&#x3055;&#x305B;&#x307E;&#x3059;&#x3002;
	 * @param {number} [exit_code=0] 
	 */
	static exit(exit_code) {
		WScript.Quit(exit_code ? exit_code : 0);
	}
	
	/**
	 * CUI&#x3067;&#x8D77;&#x52D5;&#x3057;&#x306A;&#x304A;&#x3059;
	 * @param {boolean} [is_use_chakra] - &#x9AD8;&#x901F;&#x306A;Chakra&#x30A8;&#x30F3;&#x30B8;&#x30F3;&#x3092;&#x5229;&#x7528;&#x3059;&#x308B;&#xFF08;wsf&#x304C;&#x958B;&#x3051;&#x306A;&#x304F;&#x306A;&#x308B;&#xFF09;
	 */
	static executeOnCScript(is_use_chakra) {
		const iis_use_chakra = is_use_chakra !== undefined ? is_use_chakra : false;
		if(is_wscript) {
			// CScript &#x3067;&#x8D77;&#x52D5;&#x3057;&#x306A;&#x304A;&#x3059;
			const code = [];
			const args = System.getArguments();
			code.push(&quot;\&quot;C:\\Windows\\System32\\cscript.exe\&quot;&quot;);
			code.push(&quot;//NoLogo&quot;);
			if(iis_use_chakra) {
				code.push(&quot;//E:{16d51579-a30b-4c8b-a276-0ff4dc41e755}&quot;);
			}
			code.push(&quot;\&quot;&quot; + WScript.ScriptFullName + &quot;\&quot;&quot;);
			for(let i = 0; i &lt; args.length; i++) {
				code.push(&quot;\&quot;&quot; + args[i] + &quot;\&quot;&quot;);
			}
			System.run(code.join(&quot; &quot;));
			System.exit();
		}
	}
	
	/**
	 * GUI&#x3067;&#x8D77;&#x52D5;&#x3057;&#x306A;&#x304A;&#x3059;
	 */
	static executeOnWScript() {
		// cscript&#x3067;&#x8D77;&#x52D5;&#x3057;&#x3066;&#x3044;&#x308B;&#x304B;
		if(is_cscript) {
			// WScript &#x3067;&#x8D77;&#x52D5;&#x3057;&#x306A;&#x304A;&#x3059;
			const code = [];
			const args = System.getArguments();
			code.push(&quot;\&quot;C:\\Windows\\System32\\wscript.exe\&quot;&quot;);
			code.push(&quot;\&quot;&quot; + WScript.ScriptFullName + &quot;\&quot;&quot;);
			for(let i = 0; i &lt; args.length; i++) {
				code.push(&quot;\&quot;&quot; + args[i] + &quot;\&quot;&quot;);
			}
			System.run(code.join(&quot; &quot;));
			System.exit();
		}
	}
	
	/**
	 * &#x6307;&#x5B9A;&#x3057;&#x305F;&#x74B0;&#x5883;&#x5909;&#x6570;&#x306E;&#x5024;&#x3092;&#x53D6;&#x5F97;&#x3059;&#x308B;
	 * @param {string} env_name &#x74B0;&#x5883;&#x5909;&#x6570;&#xFF08;%&#x306F;&#x7701;&#x7565;&#x53EF;&#x80FD;&#xFF09;
	 * @returns {string}
	 */
	 static getEnvironmentString(env_name) {
		const shell = new ActiveXObject(&quot;WScript.Shell&quot;);
		const env_param = &quot;%&quot; + env_name.replace(/%/g, &quot;&quot;) + &quot;%&quot;;
		const env_value = shell.ExpandEnvironmentStrings(env_param);
		return env_param === env_value ? &quot;&quot; : env_value;
	}

	/**
	 * &#x30B9;&#x30AF;&#x30EA;&#x30D7;&#x30C8;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x3078;&#x306E;&#x5F15;&#x6570;&#x3092;&#x53D6;&#x5F97;
	 * @returns {string[]}
	 */
	static getArguments() {
		const args = [];
		for(let i = 0; i &lt; WScript.Arguments.length; i++) {
			args[i] = WScript.Arguments(i);
		}
		return args;
	}

	/**
	 * &#x30AB;&#x30EC;&#x30F3;&#x30C8;&#x30C7;&#x30A3;&#x30EC;&#x30AF;&#x30C8;&#x30EA;&#x3092;&#x8A2D;&#x5B9A;
	 * @param {string} filename
	 */
	static setCurrentDirectory(filename) {
		const shell = new ActiveXObject(&quot;WScript.Shell&quot;);
		shell.CurrentDirectory = filename.toString();
	}
	
	/**
	 * &#x30AB;&#x30EC;&#x30F3;&#x30C8;&#x30C7;&#x30A3;&#x30EC;&#x30AF;&#x30C8;&#x30EA;&#x3092;&#x53D6;&#x5F97;
	 * @returns {string}
	 */
	static getCurrentDirectory() {
		const shell = new ActiveXObject(&quot;WScript.Shell&quot;);
		return shell.CurrentDirectory;
	}

	/**
	 * &#x5B9F;&#x884C;&#x4E2D;&#x306E;&#x30B9;&#x30AF;&#x30EA;&#x30D7;&#x30C8;&#x304C;&#x3042;&#x308B;&#x30AB;&#x30EC;&#x30F3;&#x30C8;&#x30C7;&#x30A3;&#x30EC;&#x30AF;&#x30C8;&#x30EA;&#x3092;&#x53D6;&#x5F97;
	 * @returns {string}
	 */
	static getScriptDirectory() {
		const x = WSH.ScriptFullName.match(/.*\\/)[0];
		return(x.substring(0 ,x.length - 1));
	}
	
	/**
	 * &#x5B9F;&#x884C;&#x4E2D;&#x306E;&#x30B9;&#x30AF;&#x30EA;&#x30D7;&#x30C8;&#x304C;&#x3042;&#x308B;&#x30C7;&#x30A3;&#x30EC;&#x30AF;&#x30C8;&#x30EA;&#x3092;&#x30AB;&#x30EC;&#x30F3;&#x30C8;&#x30C7;&#x30A3;&#x30EC;&#x30AF;&#x30C8;&#x30EA;&#x306B;&#x8A2D;&#x5B9A;
	 */
	static initializeCurrentDirectory() {
		const shell = WScript.CreateObject(&quot;WScript.Shell&quot;);
		shell.CurrentDirectory = System.getScriptDirectory();
	}

	/**
	 * PowerShell &#x3092;&#x5B9F;&#x884C;&#x3059;&#x308B;
	 * - &#x30B9;&#x30EC;&#x30C3;&#x30C9;&#x30BB;&#x30FC;&#x30D5;&#x30E2;&#x30FC;&#x30C9;&#x3001;&#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x30E2;&#x30FC;&#x30C9;&#x3067;&#x5B9F;&#x884C;&#x3057;&#x307E;&#x3059;
	 * 
	 * @param {string} source
	 * @returns {string}
	 */
	static PowerShell(source) {
		// &#x30B9;&#x30EC;&#x30C3;&#x30C9;&#x30BB;&#x30FC;&#x30D5;&#x30E2;&#x30FC;&#x30C9;&#x3067;&#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x30E2;&#x30FC;&#x30C9;&#x3067;&#x5B9F;&#x884C;&#x3059;&#x308B;
		const powershell_base = &quot;powershell -sta -Command&quot;;
		const command = (powershell_base + &quot; &quot; + source).replace(/([\\&quot;])/g, &quot;\\$1&quot;);
		return System.exec(command).out.replace(/\r?\n$/, &quot;&quot;);
	}

	/**
	 * WindowsAPI &#x3092;&#x5B9F;&#x884C;&#x3059;&#x308B;
	 * 
	 * &#x4F8B;
	 * - `dll_name` : `&quot;user32.dll&quot;`
	 * - `function_text` : `&quot;int MessageBox(IntPtr hWnd, string lpText, string lpCaption, UInt32 uType)&quot;&quot;`
	 * - `exec_text` : `&quot;$api::MessageBox(0, \&quot;&#x30C6;&#x30AD;&#x30B9;&#x30C8;\&quot;, \&quot;&#x30AD;&#x30E3;&#x30D7;&#x30B7;&#x30E7;&#x30F3;\&quot;, 0);&quot;`
	 * @param {string} dll_name - &#x5229;&#x7528;&#x3059;&#x308B;dll
	 * @param {string} function_text - &#x95A2;&#x6570;&#x306E;&#x5B9A;&#x7FA9;&#x30C7;&#x30FC;&#x30BF;(`$api`&#x306B;&#x4EE3;&#x5165;&#x3055;&#x308C;&#x307E;&#x3059;&#x3002;)
	 * @param {string} exec_text - &#x5B9F;&#x884C;&#x30B3;&#x30DE;&#x30F3;&#x30C9;
	 * @returns {string}
	 */
	static WindowsAPI(dll_name, function_text, exec_text) {
		// &#x5229;&#x7528;&#x4F8B;
		// System.WindowsAPI(
		// 	&quot;user32.dll&quot;,
		// 	&quot;int MessageBox(IntPtr hWnd, string lpText, string lpCaption, UInt32 uType)&quot;,
		// 	&quot;$api::MessageBox(0, \&quot;&#x30C6;&#x30AD;&#x30B9;&#x30C8;\&quot;, \&quot;&#x30AD;&#x30E3;&#x30D7;&#x30B7;&#x30E7;&#x30F3;\&quot;, 0);&quot;
		// );
		//

		/*
			PowerShell 2.0 &#x306E; Add-Type &#x3092;&#x4F7F;&#x7528;&#x3057;&#x3066;&#x3044;&#x308B;
			$api = Add-Type -Name &quot;api&quot; -MemberDefinition &apos;
				[DllImport(&quot;user32.dll&quot;)] public extern static int MessageBox(IntPtr hWnd, string lpText, string lpCaption, UInt32 uType);
			&apos; -PassThru;
			$api::MessageBox(0, \&quot;&#x30C6;&#x30AD;&#x30B9;&#x30C8;\&quot;, \&quot;&#x30AD;&#x30E3;&#x30D7;&#x30B7;&#x30E7;&#x30F3;\&quot;, 0);
		*/

		// &#x30C0;&#x30D6;&#x30EB;&#x30AF;&#x30A9;&#x30FC;&#x30C6;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x3060;&#x3068;&#x30A8;&#x30B9;&#x30B1;&#x30FC;&#x30D7;&#x304C;&#x9762;&#x5012;&#x306A;&#x306E;&#x3067;&#x3001;&#x3053;&#x3053;&#x306F;&#x30B7;&#x30F3;&#x30B0;&#x30EB;&#x30AF;&#x30A9;&#x30FC;&#x30C6;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x4F7F;&#x7528;&#x3059;&#x308B;
		// eslint-disable-next-line quotes
		const api_base = `$api = Add-Type -Name &quot;api&quot; -MemberDefinition &quot;[DllImport(&quot;&quot;` + dll_name + `&quot;&quot;)] public extern static ` + function_text + `;&quot; -PassThru;`;
		const command = api_base + &quot; &quot; + exec_text;
		return System.PowerShell(command);
	}

	/**
	 * &#x30AF;&#x30EA;&#x30C3;&#x30D7;&#x30DC;&#x30FC;&#x30C9;&#x304B;&#x3089;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x3092;&#x53D6;&#x5F97;&#x3059;&#x308B;
	 * @returns {string}
	 */
	static getClipBoardText() {
		/*
			Add-Type -Assembly System.Windows.Forms;
			[System.Windows.Forms.Clipboard]::GetText();
		*/
		const command = &quot;Add-Type -Assembly System.Windows.Forms; [System.Windows.Forms.Clipboard]::GetText();&quot;;
		return System.PowerShell(command);
	}

	/**
	 * &#x30AF;&#x30EA;&#x30C3;&#x30D7;&#x30DC;&#x30FC;&#x30C9;&#x3078;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x3092;&#x8A2D;&#x5B9A;&#x3059;&#x308B;
	 * @param {string} text
	 */
	static setClipBoardText(text) {
		/*
			Add-Type -Assembly System.Windows.Forms;
			[System.Windows.Forms.Clipboard]::SetText(\&quot;&quot; + text + &quot;\&quot;, 1);
		*/
		const command = &quot;Add-Type -Assembly System.Windows.Forms; [System.Windows.Forms.Clipboard]::SetText(\&quot;&quot; + text + &quot;\&quot;, 1);&quot;;
		// PowerShell 5.0&#x4EE5;&#x964D;
		// command = &quot;Set-Clipboard \&quot;&#x3053;&#x308C;&#x3067;&#x3082;&#x30B3;&#x30D4;&#x30FC;&#x53EF;&#x80FD;\&quot;&quot;;
		System.PowerShell(command);
	}

	/**
	 * `XMLHttpRequest` &#x3092;&#x4F5C;&#x6210;
	 * - &#x53D6;&#x5F97;&#x3067;&#x304D;&#x306A;&#x3044;&#x5834;&#x5408;&#x306F; `null`
	 * 
	 * @returns {XMLHttpRequest}
	 */
	 static createXMLHttpRequest() {
		try {
			return new XMLHttpRequest();
		}
		catch (e) {
			const MSXMLHTTP = [
				&quot;WinHttp.WinHttpRequest.5.1&quot;,
				&quot;WinHttp.WinHttpRequest.5&quot;,
				&quot;WinHttp.WinHttpRequest&quot;,
				&quot;Msxml2.ServerXMLHTTP.6.0&quot;,
				&quot;Msxml2.ServerXMLHTTP.5.0&quot;,
				&quot;Msxml2.ServerXMLHTTP.4.0&quot;,
				&quot;Msxml2.ServerXMLHTTP.3.0&quot;,
				&quot;Msxml2.ServerXMLHTTP&quot;,
				&quot;Microsoft.ServerXMLHTTP&quot;,
				&quot;Msxml2.XMLHTTP.6.0&quot;,
				&quot;Msxml2.XMLHTTP.5.0&quot;,
				&quot;Msxml2.XMLHTTP.4.0&quot;,
				&quot;Msxml2.XMLHTTP.3.0&quot;,
				&quot;Msxml2.XMLHTTP&quot;,
				&quot;Microsoft.XMLHTTP&quot;
			];
			// &#x203B; WinHttp.WinHttpRequest &#x306F; onreadystatechange &#x306E;&#x66F8;&#x304D;&#x63DB;&#x3048;&#x304C;&#x3067;&#x304D;&#x306A;&#x3044;
			for(let i = 0; i &lt; MSXMLHTTP.length; i++) {
				try {
					return new ActiveXObject(MSXMLHTTP[i]);
				}
				catch (e) {
					continue;
				}
			}
			return null;
		}
	}

	/**
	 * `MSXML2.DOMDocument` &#x3092;&#x4F5C;&#x6210;
	 * - &#x53D6;&#x5F97;&#x3067;&#x304D;&#x306A;&#x3044;&#x5834;&#x5408;&#x306F; `null`
	 * 
	 * @returns {any}
	 */
	 static createMSXMLDOMDocument() {
		const MSXMLDOM = [
			&quot;Msxml2.DOMDocument.6.0&quot;,
			&quot;Msxml2.DOMDocument.3.0&quot;,
			&quot;Msxml2.DOMDocument&quot;,
			&quot;Microsoft.XMLDOM&quot;
		];
		for(let i = 0; i &lt; MSXMLDOM.length; i++) {
			try {
				return new ActiveXObject(MSXMLDOM[i]);
			}
			catch (e) {
				continue;
			}
		}
		return null;
	}

	/**
	 * `Byte &#x914D;&#x5217;` &#x304B;&#x3089;&#x6570;&#x5024;&#x914D;&#x5217;&#x3092;&#x4F5C;&#x6210;&#x3059;&#x308B;
	 * - `ADODB.Stream` &#x306A;&#x3069;&#x3092;&#x7528;&#x3044;&#x3066;&#x53D6;&#x5F97;&#x3057;&#x305F;&#x30D0;&#x30A4;&#x30CA;&#x30EA;&#x914D;&#x5217;&#x3092; `JavaScript` &#x3067;&#x3082;&#x6271;&#x3048;&#x308B;&#x578B;&#x3078;&#x5909;&#x66F4;&#x3059;&#x308B;
	 * 
	 * @param {any} byte_array
	 * @returns {number[]}
	 */
	static createNumberArrayFromByteArray(byte_array) {
		const dom = System.createMSXMLDOMDocument();
		if(dom === null) {
			console.log(&quot;createMSXMLDOMDocument&quot;)
			return [];
		}

		// &#x30D0;&#x30A4;&#x30C8;&#x914D;&#x5217;&#x304B;&#x3089;16&#x9032;&#x6570;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x3078;&#x5909;&#x63DB;
		// &#x53C2;&#x8003;
		// https://qiita.com/tnakagawa/items/9bcc26b501f5b995d896
		const element = dom.createElement(&quot;hex&quot;);
		element.dataType = &quot;bin.hex&quot;;
		element.nodeTypedValue = byte_array;
		/**
		 * @type {string}
		 */
		const hex_text = element.text;
		const out = new Array(hex_text.length / 2);
		// &#x30D0;&#x30A4;&#x30C8;&#x6587;&#x5B57;&#x5217;&#x304B;&#x3089;&#x914D;&#x5217;&#x3078;&#x5909;&#x66F4;
		for(let i = 0; i &lt; out.length; i++) {
			out[i] = Number.parseInt(hex_text.substr(i * 2, 2), 16);
		}
		return out;
	}

	/**
	 * &#x6570;&#x5024;&#x914D;&#x5217;&#x304B;&#x3089;`Byte &#x914D;&#x5217;`&#x3092;&#x4F5C;&#x6210;&#x3059;&#x308B;
	 * - `ADODB.Stream` &#x306A;&#x3069;&#x3092;&#x7528;&#x3044;&#x3066;&#x53D6;&#x5F97;&#x3057;&#x305F;&#x30D0;&#x30A4;&#x30CA;&#x30EA;&#x914D;&#x5217;&#x3092; `JavaScript` &#x3067;&#x3082;&#x6271;&#x3048;&#x308B;&#x578B;&#x3078;&#x5909;&#x66F4;&#x3059;&#x308B;
	 * - `offset` &#x3092;&#x6307;&#x5B9A;&#x3057;&#x305F;&#x5834;&#x5408;&#x306F;&#x3001;&#x51FA;&#x529B;&#x3057;&#x305F;&#x30D0;&#x30A4;&#x30C8;&#x914D;&#x5217;&#x306F;&#x305D;&#x306E;&#x4F4D;&#x7F6E;&#x307E;&#x3067;&#x306F; `NUL` &#x3067;&#x57CB;&#x307E;&#x3063;&#x305F;&#x914D;&#x5217;&#x3068;&#x306A;&#x308B;
	 * 
	 * @param {number[]} number_array
	 * @param {number} [offset = 0]
	 * @returns {any}
	 */
	 static createByteArrayFromNumberArray(number_array, offset) {
		const dom = System.createMSXMLDOMDocument();
		if(dom === null) {
			console.log(&quot;createMSXMLDOMDocument&quot;)
			return null;
		}
		let max_size = offset !== undefined ? offset : 0;
		let hex_string = [];
		// offset&#x304C;&#x8A2D;&#x5B9A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x5834;&#x5408;&#x306F;&#x3001;&#x30AA;&#x30D5;&#x30BB;&#x30C3;&#x30C8;&#x4F4D;&#x7F6E;&#x307E;&#x3067;00&#x3067;&#x57CB;&#x3081;&#x308B;
		let p;
		for(p = 0; p &lt; max_size; p++) {
			hex_string[p] = &quot;00&quot;;
		}
		max_size += number_array.length;
		// 16&#x9032;&#x6570;&#x306E;&#x6587;&#x5B57;&#x5217;&#x3092;&#x4F5C;&#x6210;&#x3059;&#x308B;
		for(let i = 0; p &lt; max_size; i++, p++) {
			if(number_array[i] &lt; 16) {
				hex_string[p] = &quot;0&quot; + number_array[i].toString(16);
			}
			else {
				hex_string[p] = number_array[i].toString(16);
			}
		}
		// &#x30D0;&#x30A4;&#x30C8;&#x914D;&#x5217;&#x304B;&#x3089;16&#x9032;&#x6570;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x3078;&#x5909;&#x63DB;
		// &#x53C2;&#x8003;
		// https://qiita.com/tnakagawa/items/9bcc26b501f5b995d896
		const element = dom.createElement(&quot;hex&quot;);
		element.dataType = &quot;bin.hex&quot;;
		element.text = hex_string.join(&quot;&quot;);
		const byte_array = element.nodeTypedValue;
		return byte_array;
	}

}


</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
